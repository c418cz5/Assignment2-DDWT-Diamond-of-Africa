@{
	Layout = "~/Views/Shared/_Layout.cshtml";
	Page.Title = "Show Database - Home";

	var showList = ViewBag.Shows;
	string searchKey = ViewBag.SearchKey;
}

<div class="container mt-4">
	<h1>Show Database</h1>

	<!-- Search Form (By Show Title & Genre Filter) -->
	<form method="get" action="@Url.Action("Index", "Home")" class="mb-4">
		<div class="row g-3">
			<div class="col-md-6">
				<input type="text" name="searchTitle" class="form-control"
					   placeholder="Search by show title..." value="@searchKey" />
			</div>
			<div class="col-md-4">
				<select name="searchGenre" class="form-control">
					<option value="">All Genres</option>
					@foreach (var genre in ViewBag.Genres)
					{
						<option value="@genre.genreId" @(ViewBag.SearchGenre == genre.genreId.ToString() ? "selected" : "")>
							@genre.genre
						</option>
					}
				</select>
			</div>
			<div class="col-md-2">
				<button type="submit" class="btn btn-primary w-100">Search</button>
			</div>
		</div>
	</form>

	<!-- Add New Show Button -->
	<div class="mb-4">
		<a href="@Url.Action("AddShow", "Home")" class="btn btn-primary">Add New Show</a>
	</div>

	<!-- Show List (Card Layout) -->
	@if (showList == null || showList.Count == 0)
	{
		<div class="alert alert-info">
			No shows found. Please try a different search term or genre.
		</div>
	}
	else
	{
		<div class="row">
			@foreach (var show in showList)
			{
				<div class="col-md-4 mb-4">
					<div class="card h-100 shadow-sm">
						<div class="card-body">
							<h5 class="card-title">@show.title</h5>
							<p class="card-text"><strong>Year:</strong> @(string.IsNullOrEmpty(show.releaseYear) ? "N/A" : show.releaseYear)</p>
							<p class="card-text"><strong>Genre:</strong> @show.genres</p>
							<p class="card-text"><strong>Director:</strong> @show.directorName</p>
						</div>
						<div class="card-footer bg-transparent">
							<a href="@Url.Action("Details", "Home", new { videoId = show.videoId })"
							   class="btn btn-info btn-sm">More Details</a>
							<a href="@Url.Action("Update", "Home", new { id = show.videoId })"
							   class="btn btn-warning btn-sm ms-2">Update Details</a>
						</div>
					</div>
				</div>
			}
		</div>
	}
</div>